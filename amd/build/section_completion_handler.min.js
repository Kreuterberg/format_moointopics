define("format_moointopics/section_completion_handler",["exports","core/ajax","core/notification","core/str","core/modal_factory","format_moointopics/mooin4Modal","core/templates","core/url"],(function(_exports,_ajax,_notification,_str,_modal_factory,_mooin4Modal,_templates,_url){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_modal_factory=_interopRequireDefault(_modal_factory),_mooin4Modal=_interopRequireDefault(_mooin4Modal),_templates=_interopRequireDefault(_templates);const Selectors_actions={buttonClicked:'[data-action="format_moointopics/section_completion_handler-button"]'};_exports.init=async _ref=>{let{section_id:section_id,isLastSectionOfChapter:isLastSectionOfChapter,courseCompletedAlready:courseCompletedAlready}=_ref;if(isLastSectionOfChapter){(await _modal_factory.default.create({title:await(0,_str.get_string)("modal_last_section_of_chapter_title","format_moointopics"),body:"<p>"+await(0,_str.get_string)("modal_last_section_of_chapter","format_moointopics")+'</p><i class="bi bi-star"></i>',footer:'<button type="button" class="mooin4-btn mooin4-btn-primary"data-action="hide">'+await(0,_str.get_string)("close","format_moointopics")+'<i class="bi bi-x-circle-fill"></i></button>',type:_mooin4Modal.default.TYPE,scrollable:!1})).show()}let progressbar=document.getElementById("mooin4ection".concat(section_id)),percentageText=document.getElementById("mooin4ection-text-".concat(section_id)),navdrawerSection=document.querySelector('[data-key="'.concat(section_id,'"]'));document.addEventListener("click",(e=>{e.target.closest(Selectors_actions.buttonClicked)&&_ajax.default.call([{methodname:"format_moointopics_check_completion_status",args:{section_id:Number(section_id),isActivity:!1,course_already_completed:courseCompletedAlready,chapter_already_completed:!1}}])[0].done((async function(data){e.target.textContent=await(0,_str.get_string)("page_read","format_moointopics"),e.target.classList.add("completed"),navdrawerSection.classList.add("completed"),e.target.disabled=!0,progressbar.style.width="100%",percentageText.innerText="100% ";var message={action:"showModal",modal:{data:data}};window.postMessage(message,"*")})).fail()}))}}));

//# sourceMappingURL=section_completion_handler.min.js.map